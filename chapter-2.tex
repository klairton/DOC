
Neste capítulo, apresentaremos as formas como um genoma será representado e como os eventos de rearranjo de genomas podem afetá-lo. Além disso, definiremos o formato das instâncias utilizadas pelos problemas investigados nos capítulos seguintes e apresentaremos definições e conceitos utilizados para obtenção de resultados.

% ------------------------------------------------------------------ %
\section{Representação de Genomas}
% ------------------------------------------------------------------ %

Nesta seção, apresentamos três representações de genomas que diferem quanto às estruturas genéticas incorporadas na representação computacional.

Dado um genoma $\mathcal{G}=(\mathcal{G}_1,\:\mathcal{G}_2,\allowbreak\:\dots,\:\mathcal{G}_n)$ com $n$ genes não repetidos, utilizamos uma representação através de uma permutação $\pi=(\pi_1~\pi_2~\dots~\pi_n)$, de forma que cada elemento $\pi_i$, com $1 \le i \le n$, da permutação $\pi$ representa o gene $\mathcal{G}_i$ do genoma $\mathcal{G}$. Caso a orientação dos genes no genoma $\mathcal{G}$ seja conhecida, associamos um sinal ``$+$'' ou ``$-$'' a cada elemento $\pi_i \in \pi$ para representar a orientação de cada um dos genes de $\mathcal{G}$. Caso contrário, o sinal é omitido. Quando representamos um genoma utilizando apenas as informações obtidas com base no posicionamento dos genes, denominamos de \emph{representação clássica}. Além disso, denotamos por \emph{representação clássica com sinais} quando a orientação dos genes é conhecida e por \emph{representação clássica sem sinais} caso contrário. O Exemplo~\ref{example:AGNBBMYY} mostra representações clássicas com sinais e sem sinais de genomas fictícios. Os elementos coloridos com letras no interior representam os genes. Na parte superior os elementos possuem orientação e na parte inferior não possuem.

\input{examples/AGNBBMYY}

Dado um genoma $\mathcal{G}=(\mathfrak{R}_1,\mathcal{G}_1,\mathfrak{R}_2,\mathcal{G}_2\dots,\mathfrak{R}_n,\mathcal{G}_n,\mathfrak{R}_{n+1})$ com $n$ genes não repetidos $\{\mathcal{G}_1,\:\mathcal{G}_2,\:\dots,\:\mathcal{G}_n\}$ e $n+1$ regiões intergênicas $\{\mathfrak{R}_1,\:\mathfrak{R}_2,\:\dots,\:\mathfrak{R}_{n+1}$\}, utilizamos essas duas características para representar um genoma. As regiões intergênicas estão presentes nas extremidades do genoma e entre cada par de genes consecutivos. Denotamos o \emph{tamanho} de uma região intergênica pela quantidade de nucleotídeos contida nela. Representamos o genoma $\mathcal{G}$ utilizando dois elementos, sendo o primeiro elemento uma permutação $\pi=(\pi_1~\pi_2~\dots~\pi_n)$, de forma que cada elemento $\pi_i$, com $1 \le i \le n$, da permutação $\pi$ representa o gene $\mathcal{G}_i$ do genoma $\mathcal{G}$. Caso a orientação dos genes no genoma $\mathcal{G}$ seja conhecida, associamos um sinal ``$+$'' ou ``$-$'' a cada elemento $\pi_i \in \pi$ para representar a orientação de cada um dos genes de $\mathcal{G}$. Caso contrário, o sinal é omitido. O segundo elemento é uma lista de número inteiros não negativos $\breve\pi=(\breve\pi_1,\breve\pi_2,\dots,\breve\pi_{n+1})$, de forma que cada elemento $\breve\pi_i$, com $1 \le i \le {n+1}$, da lista $\breve\pi$ representa o tamanho da região intergênica $\mathfrak{R}_i$ do genoma $\mathcal{G}$. Quando representamos um genoma utilizando a informação do posicionamento dos genes e os tamanhos das regiões intergênicas, denominamos de \emph{representação intergênica rígida}. Além disso, denotamos por \emph{representação intergênica rígida com sinais} quando a orientação dos genes é conhecida e por \emph{representação intergênica rígida sem sinais} caso contrário. O Exemplo~\ref{example:ARGRKMMV} mostra representações intergênicas rígidas com sinais e sem sinais de genomas fictícios. Os elementos coloridos com letras no interior representam os genes, sendo que na parte superior eles possuem orientação e na parte inferior não possuem. Os retângulos com bordas arredondadas, localizados nas extremidades e entre cada par de genes, representam as regiões intergênicas, com o número no interior indicando seu tamanho. 

\input{examples/ARGRKMMV}

Para tornar a especificação em relação ao tamanho de cada região intergênica menos rígida, criamos uma representação denominada de \emph{representação intergênica flexível}. Para isso, representamos um genoma $\mathcal{G}=(\mathfrak{R}_1,\mathcal{G}_1,\mathfrak{R}_2,\mathcal{G}_2\dots,\mathfrak{R}_n,\mathcal{G}_n,\mathfrak{R}_{n+1})$ com $n$ genes não repetidos $\{\mathcal{G}_1,\:\mathcal{G}_2,\:\dots,\:\mathcal{G}_n\}$ e $n+1$ regiões intergênicas $\{\mathfrak{R}_1,\:\mathfrak{R}_2,\:\dots,\:\mathfrak{R}_{n+1}$\} utilizando três elementos. O primeiro elemento é uma permutação $\pi=(\pi_1~\pi_2~\dots~\pi_n)$, de forma que cada elemento $\pi_i$, com $1 \le i \le n$, da permutação $\pi$ representa o gene $\mathcal{G}_i$ do genoma $\mathcal{G}$. Caso a orientação dos genes no genoma $\mathcal{G}$ seja conhecida, associamos um sinal ``$+$'' ou ``$-$'' a cada elemento $\pi_i \in \pi$ para representar a orientação de cada um dos genes de $\mathcal{G}$. Caso contrário, o sinal é omitido. Os demais elementos são duas listas de número inteiros não negativos $\breve\pi^{\min}=(\breve\pi^{\min}_1,\breve\pi^{\min}_2,\dots,\breve\pi^{\min}_{n+1})$ e $\breve\pi^{\max}=(\breve\pi^{\max}_1,\breve\pi^{\max}_2,\dots,\breve\pi^{\max}_{n+1})$, de forma que $\breve\pi^{\min}_i \le \breve\pi^{\max}_i$ e o tamanho da região intergênica $\mathfrak{R}_i$ pertence ao intervalo $[\breve\pi^{\min}_{i} .. \breve\pi^{\max}_{i}]$, com $1 \le i \le {n+1}$. Isso faz com que o tamanho de cada região intergênica seja flexível, tornando possível especificar um intervalo de valores aceitáveis para o tamanho de cada uma delas ao invés de apenas um único valor. Por fim, denotamos por \emph{representação intergênica flexível com sinais} quando a orientação dos genes é conhecida e por \emph{representação intergênica flexível sem sinais} caso contrário. O Exemplo~\ref{example:BIXCBOSI} mostra representações intergênicas flexíveis com sinais e sem sinais de genomas fictícios. Os elementos coloridos com letras no interior representam os genes, sendo que na parte superior eles possuem orientação e na parte inferior não possuem. Os retângulos com bordas arredondadas, localizados nas extremidades e entre cada par de genes, representam as regiões intergênicas. O número na parte superior de cada região intergênica indica o tamanho máximo permitido, enquanto o número na parte inferior indica o tamanho mínimo permitido.

\input{examples/BIXCBOSI}

Dada a representação $\mathcal{R}$ de um genoma $\mathcal{G}$, seja na forma clássica $\mathcal{R}=(\pi)$, intergênica rígida $\mathcal{R}=(\pi,\breve\pi)$ ou intergênica flexível $\mathcal{R}=(\pi,\breve\pi^{\min},\breve\pi^{\max})$, obtemos sua versão estendida adicionando dois novos elementos em $\pi$, com $\pi_0 = 0$ e $\pi_{n+1} = {n+1}$ inseridos no início e no fim da permutação $\pi$, respectivamente. Esses dois novos elementos adicionados em $\pi$ representam genes fictícios que não serão afetados por nenhum evento de rearranjo de genomas, e serão utilizados apenas para tornar algumas definições mais simples. De agora em diante, assumimos que qualquer representação de genoma estará na sua forma estendida, a não ser que seja dito expressamente o contrário.

% ------------------------------------------------------------------ %
\section{Eventos de Rearranjo}
% ------------------------------------------------------------------ %

Nesta seção, apresentamos os eventos de rearranjo considerados nesta tese e como eles podem afetar o genoma dependendo da representação utilizada. 

Os eventos de rearranjo de genomas são classificados em \emph{conservativos} ou \emph{não conservativos}. Os eventos de rearranjo conservativos não alteram a quantidade de material genético do genoma, enquanto os eventos de rearranjo não conservativos, sim. Dado um evento de rearranjo $\gamma$ e uma representação $\mathcal{R}$ de um genoma, denotamos por $\mathcal{R} \cdot  \gamma$ o genoma resultante após a aplicação do evento de rearranjo $\gamma$ em $\mathcal{R}$. De maneira similar, quando temos uma sequência de eventos de rearranjo $S=(\gamma_1,\gamma_2,\dots,\gamma_k)$ e uma representação $\mathcal{R}$ de um genoma, denotamos por $\mathcal{R} \cdot S = \mathcal{R} \cdot \gamma_1 \cdot \gamma_2 \cdot \ldots \cdot \gamma_k$ como sendo o genoma resultante após a aplicação da sequência $S$ em $\mathcal{R}$. A seguir, mostramos como os eventos de rearranjo conservativos de reversão e transposição afetam a representação clássica de um genoma.

\begin{definition}
Dada uma representação clássica de um genoma $\mathcal{R} = (\pi)$, sejam $i$ e $j$ números inteiros tais que $1 \le i \le j \le n$. Uma reversão $\rho^{(i,j)}$ inverte o segmento $(\pi_i~\pi_{i+1}~\dots~\pi_{j-1}~\pi_j)$ de $\pi$. Caso a representação $\mathcal{R}$ do genoma seja clássica com sinais, o sinal de cada elemento no segmento $(\pi_i~\pi_{i+1}~\dots~\pi_{j-1}~\pi_j)$ também é invertido.
\end{definition}

Os exemplos~\ref{example:BJBDRCHL} e~\ref{example:COJXWMAC} mostram uma reversão $\rho^{(i,j)}$ genérica sendo aplicada em uma representação clássica com e sem sinais de um genoma, respectivamente.

\input{examples/BJBDRCHL}

\input{examples/COJXWMAC}

O Exemplo~\ref{example:DCRMAYUA} mostra uma reversão $\rho^{(2,4)}$ sendo aplicada na representação clássica com sinais $\mathcal{R} = (\pi) = ({+0}~{-3}~{+2}~{-4}~{+1}~{+5}~{+6})$ de um genoma, enquanto o Exemplo~\ref{example:DOFVIMRX} mostra uma reversão $\rho^{(1,5)}$ sendo aplicada na representação clássica sem sinais $\mathcal{R} = (\pi) = ({0}~{4}~{5}~{3}~{2}~{1}~{6})$ de um genoma.

\input{examples/DCRMAYUA}

\input{examples/DOFVIMRX}

\begin{definition}
Dada uma representação clássica de um genoma $\mathcal{R} = (\pi)$, sejam $i$, $j$ e $k$ números inteiros tais que $1 \le i < j < k \le n + 1$. Uma transposição $\tau^{(i,j,k)}$ troca a posição dos segmentos consecutivos $(\pi_i~\pi_{i+1}~\dots~\pi_{j-1})$ e $(\pi_j~\pi_{j+1}~\dots~\pi_{k-1})$ de $\pi$.
\end{definition}

O Exemplo~\ref{example:EZZBDRDA} mostra uma transposição $\tau^{(i,j,k)}$ genérica sendo aplicada em uma representação clássica de um genoma. Note que a transposição pode ser aplicada em ambas as representações clássicas, com e sem sinais.

\input{examples/EZZBDRDA}

O Exemplo~\ref{example:HFLGUNSS} mostra uma transposição $\tau^{(1,3,5)}$ sendo aplicada na representação clássica com sinais $\mathcal{R} = (\pi) = ({+0}~{-4}~{-3}~{+1}~{+2}~{+5}~{+6})$ de um genoma, enquanto o Exemplo~\ref{example:HGHICRCG} mostra uma transposição $\tau^{(4,5,6)}$ sendo aplicada na representação clássica sem sinais $\mathcal{R} = (\pi) = ({0}~{3}~{2}~{1}~{5}~{4}~{6})$ de um genoma.

\input{examples/HFLGUNSS}

\input{examples/HGHICRCG}

A seguir, mostramos como os eventos de rearranjo conservativos de reversão intergênica, transposição intergênica e move intergênico afetam a representação intergênica rígida de um genoma. 

\begin{definition}
Dada uma representação intergênica rígida de um genoma $\mathcal{R} = (\pi,\breve\pi)$, sejam $i$, $j$, $x$ e $y$ números inteiros tais que $1 \le i \le j \le n$, $0 \le x \le \breve\pi_i$ e $0 \le y \le \breve\pi_{j+1}$. Uma reversão intergênica $\rho^{(i, j)}_{(x, y)}$ divide as regiões intergênicas $\breve\pi_i$ e $\breve\pi_{j+1}$ da seguinte forma: $\breve\pi_i$ em duas partes com tamanhos $x$ e $x^{\prime}$, onde $x^{\prime}=\breve\pi_i-x$; e $\breve\pi_{j+1}$ em duas partes com tamanhos $y$ e $y^{\prime}$, onde $y^{\prime}=\breve\pi_{j+1}-y$. Em seguida, o segmento $(x^{\prime},\pi_i,\breve\pi_{i+1}\dots\breve\pi_j,\pi_j,y)$ do genoma é invertido. Caso a representação seja com sinais, os sinais dos elementos de $\pi_i$ até $\pi_{j}$ também são invertidos. Por fim, os segmentos do genoma são remontados com os pares de partes $(x,y)$ e $(x^{\prime},y^{\prime})$ fundindo-se e formando as novas regiões intergênicas $\breve\pi_i$ e $\breve\pi_{j+1}$ com tamanhos $x + y$ e $x^{\prime}+y^{\prime}$, respectivamente.
\end{definition}

O Exemplo~\ref{example:HJOTQJWJ} mostra uma reversão intergênica $\rho^{(i, j)}_{(x, y)}$ genérica sendo aplicada em uma representação intergênica rígida com sinais de um genoma.

\input{examples/HJOTQJWJ}

O Exemplo~\ref{example:KQWRJKOC} mostra uma reversão intergênica $\rho^{(i, j)}_{(x, y)}$ genérica sendo aplicada em uma representação intergênica rígida sem sinais de um genoma.

\pagebreak

\input{examples/KQWRJKOC}

O Exemplo~\ref{example:KXVBWBTB} mostra uma reversão intergênica $\rho^{(2,4)}_{(2,0)}$ sendo aplicada na representação intergênica rígida com sinais $\mathcal{R} = (\pi,\breve\pi) = \allowbreak(({+0}~{-3}~{+2}~{-4}~{+1}~{+5}~{+6}),\allowbreak(1,4,4,2,0,3))$ de um genoma, enquanto o Exemplo~\ref{example:KXXIMDRH} mostra uma reversão intergênica $\rho^{(1,5)}_{(1,2)}$ sendo aplicada na representação intergênica rígida sem sinais $\mathcal{R} = (\pi,\breve\pi) = \allowbreak(({0}~{4}~{5}~{3}~{2}~{1}~{6}),\allowbreak(1,1,7,3,0,2))$ de um genoma. As regiões intergênicas marcadas com sobrescrito podem ter seus tamanhos alterados pelo evento, enquanto as regiões intergênicas marcadas com subscrito sofrem apenas uma troca de posição.

\input{examples/KXVBWBTB}

\input{examples/KXXIMDRH}

\begin{definition}
Dada uma representação intergênica rígida de um genoma $\mathcal{R} = (\pi,\breve\pi)$, sejam $i$, $j$, $k$, $x$, $y$ e $z$ números inteiros tais que $1 \le i < j < k \le n+1$, $0 \le x \le \breve\pi_i$, $0 \le y \le \breve\pi_j$ e $0 \le z \le \breve\pi_k$. Uma transposição intergênica $\tau^{(i,j,k)}_{(x,y,z)}$ divide as regiões intergênicas $\breve\pi_i$, $\breve\pi_{j}$ e $\breve\pi_k$ da seguinte forma: $\breve\pi_i$ em duas partes com tamanhos $x$ e $x^{\prime}$, onde $x^{\prime}=\breve\pi_i-x$; $\breve\pi_{j}$ em duas partes com tamanhos $y$ e $y^{\prime}$, onde $y^{\prime}=\breve\pi_{j}-y$; e $\breve\pi_{k}$ em duas partes com tamanhos $z$ e $z^{\prime}$, onde $z^{\prime}=\breve\pi_{k}-z$. Em seguida, os segmentos consecutivos $(x^{\prime},\pi_i,\breve\pi_{i+1},\dots \breve \pi_{j-1},\pi_{j-1},y)$ e $(y^{\prime},\pi_j,\breve\pi_{j+1}\dots \breve\pi_{k-1},\pi_{k-1},z)$ trocam de posição sem alterar a orientação dos genes contidos nos segmentos. Por fim, os segmentos do genoma são remontados com os pares de partes $(x,y^{\prime})$, $(z,x^{\prime})$ e $(y,z^{\prime})$ fundindo-se e formando as novas regiões intergênicas $\breve\pi_{i}$, $\breve\pi_{k+i-j}$, e $\breve\pi_{k}$ com tamanhos $x + y^{\prime}$, $z + x^{\prime}$ e $y + z^{\prime}$, respectivamente.
\end{definition}

O Exemplo~\ref{example:LIZCKUBG} mostra uma transposição intergênica $\tau^{(i,j,k)}_{(x,y,z)}$ genérica sendo aplicada em uma representação intergênica rígida de um genoma. Note que, caso a representação utilizada seja com sinais, o evento não altera a orientação dos genes nos segmentos afetados.

\pagebreak

\input{examples/LIZCKUBG}

O Exemplo~\ref{example:LLNCEMFB} mostra uma transposição intergênica $\tau^{(1,3,6)}_{(1,1,3)}$ sendo aplicada na representação intergênica rígida com sinais $\mathcal{R} = (\pi,\breve\pi) = \allowbreak(({+0}~{-4}~{-3}~{+1}~{+2}~{+5}~{+6}),\allowbreak(3,0,2,2,4,7))$ de um genoma, enquanto o Exemplo~\ref{example:LRYMWOFK} mostra uma transposição intergênica $\tau^{(4,5,6)}_{(0,0,1)}$ sendo aplicada na representação intergênica rígida sem sinais $\mathcal{R} = (\pi,\breve\pi) = \allowbreak(({0}~{3}~{2}~{1}~{5}~{4}~{6}),\allowbreak(3,2,4,1,0,2))$ de um genoma. As regiões intergênicas marcadas com sobrescrito podem ter seus tamanhos alterados pelo evento, enquanto as regiões intergênicas marcadas com subscrito sofrem apenas uma troca de posição.

\input{examples/LLNCEMFB}

\input{examples/LRYMWOFK}

\begin{definition}
Dada uma representação intergênica rígida de um genoma $\mathcal{R} = (\pi,\breve\pi)$, sejam $i$, $j$ e $x$ números inteiros tais que $1 \le i, j \le n$ e $0 \le x \le \breve\pi_i$. Um move intergênico $\mu^{(i,j)}_{(x)}$ transfere $x$ nucleotídeos da região intergênica $\breve\pi_i$ para a região intergênica $\breve\pi_{j}$.
\end{definition}

O Exemplo~\ref{example:LZHMUNDG} mostra um move intergênico $\mu^{(2,5)}_{(3)}$ sendo aplicado na representação intergênica rígida com sinais $\mathcal{R} = (\pi,\breve\pi) = \allowbreak(({+0}~{-3}~{+2}~{-4}~{+1}~{+5}~{+6}),\allowbreak(1,4,4,2,0,3))$ de um genoma, enquanto o Exemplo~\ref{example:NLNYPHRB} mostra um move intergênico $\mu^{(3,5)}_{(5)}$ sendo aplicado na representação intergênica rígida sem sinais $\mathcal{R} = (\pi,\breve\pi) = \allowbreak(({0}~{4}~{5}~{3}~{2}~{1}~{6}),\allowbreak(1,1,7,3,0,2))$ de um genoma. As regiões intergênicas marcadas com sobrescrito sofrem alteração no seu tamanho causada pelo evento.

\input{examples/LZHMUNDG}

\pagebreak

\input{examples/NLNYPHRB}

A seguir, mostramos como o evento de rearranjo não conservativo de indel intergênico afeta a representação intergênica rígida de um genoma.

\begin{definition}
Dada uma representação intergênica rígida de um genoma $\mathcal{R} = (\pi,\breve\pi)$, sejam $i$ e $x$ números inteiros tais que $1 \le i \le n$ e $x \ge -\breve\pi_i$. Um indel intergênico $\delta^{(i)}_{(x)}$ remove $x$ nucleotídeos da região intergênica $\breve\pi_i$ caso $x$ seja negativo. Caso contrário, um indel intergênico $\delta^{(i)}_{(x)}$ insere $x$ nucleotídeos na região intergênica $\breve\pi_i$.
\end{definition}

Note que o evento de rearranjo indel intergênico é uma forma compacta para definir os eventos de inserção e deleção utilizando a mesma notação. O Exemplo~\ref{example:ODSBTCQQ} mostra um indel intergênico $\delta^{(5)}_{(9)}$ sendo aplicado na representação intergênica rígida com sinais $\mathcal{R} = (\pi,\breve\pi) = \allowbreak(({+0}~{-3}~{+2}~{-4}~{+1}~{+5}~{+6}),\allowbreak(3,5,1,0,2,1))$ de um genoma, enquanto o Exemplo~\ref{example:OHVZBOMX} mostra um indel intergênico $\delta^{(6)}_{(-6)}$ sendo aplicado na representação intergênica rígida sem sinais $\mathcal{R} = (\pi,\breve\pi) = \allowbreak(({0}~{4}~{5}~{3}~{2}~{1}~{6}),\allowbreak(3,3,2,1,0,7))$ de um genoma. As regiões intergênicas marcadas com sobrescrito sofrem alteração no seu tamanho causada pelo evento.

\input{examples/ODSBTCQQ}

\input{examples/OHVZBOMX}

% ------------------------------------------------------------------ %
\section{Caracterização das Instâncias}
% ------------------------------------------------------------------ %

Os problemas investigados nesta tese têm como principal objetivo transformar uma representação de um genoma de origem $\mathcal{R}_{o}$ em uma representação de um genoma alvo $\mathcal{R}_{a}$ utilizando eventos de rearranjo de genoma para essa finalidade. Um \emph{modelo de rearranjo} $\mathcal{M}$ é um conjunto de eventos de rearranjo que podem ser utilizados para transformar um genoma em outro. Os problemas de rearranjo de genomas diferenciam-se pela representação do genoma de origem e alvo utilizada e pelo modelo de rearranjo adotado. A seguir descrevemos os tipos de instâncias que os problemas investigados posteriormente recebem como entrada. 

\begin{itemize}
\item Uma \emph{instância clássica} é caracterizada por um par de representações clássicas de genomas $(\pi,\iota)$ que compartilham o mesmo conjunto de genes, sendo que ambas as representações podem ser com ou sem sinais. Por padrão, em uma instância clássica utilizaremos $\pi$ e $\iota$ como as representações dos genomas de origem e alvo, respectivamente. O objetivo principal dos problemas que utilizam esse tipo de instância consiste em transformar $\pi$ em $\iota$.
\item Uma \emph{instância intergênica rígida} é caracterizada por um par de representações intergênicas rígidas de genomas $((\pi,\breve\pi),(\iota,\breve\iota))$ que compartilham o mesmo conjunto de genes, sendo que ambas as representações podem ser com ou sem sinais. Por padrão, em uma instância intergênica rígida utilizaremos $(\pi,\breve\pi)$ e $(\iota,\breve\iota)$ como as representações dos genomas de origem e alvo, respectivamente. O objetivo principal dos problemas que utilizam esse tipo de instância consiste em transformar $(\pi,\breve\pi)$ em $(\iota,\breve\iota)$.
\item Uma \emph{instância intergênica flexível} é caracterizada por um par de representações de genomas $((\pi,\breve\pi),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$ que compartilham o mesmo conjunto de genes, sendo a primeira representação intergênica rígida e a segunda intergênica flexível. Ambas as representações podem ser com ou sem sinais. Por padrão, em uma instância intergênica flexível utilizaremos $(\pi,\breve\pi)$ e $(\iota,\breve\iota^{\min},\breve\iota^{\max})$ como as representações dos genomas de origem e alvo, respectivamente. O objetivo principal dos problemas que utilizam esse tipo de instância consiste em transformar $(\pi,\breve\pi)$ em $(\iota,\breve\iota^{\prime})$, tal que $\forall i \in \{1,2,\dots,{n+1}\}: \breve\iota^{\min}_i \le \breve\iota^{\prime}_i \le \breve\iota^{\max}_i$.
\end{itemize}

Pelo fato dos genes serem representados por uma permutação e os genomas origem e alvo compartilharem o mesmo conjunto de genes, podemos determinar uma permutação padrão $\iota$ para os genes do genoma alvo e mapear a permutação do genoma de origem $\pi$ de acordo com os valores utilizados em $\iota$. A permutação padrão para os genes do genoma alvo é $\iota=({+1}~{+2}~\dots~{+n})$ para uma representação com sinais e $\iota=(1~2~\dots~n)$ para uma representação sem sinais. O Exemplo~\ref{example:OZBJAPOZ} mostra uma instância clássica com sinais.

\input{examples/OZBJAPOZ}

\begin{definition}
  Dada uma instância intergênica rígida $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota))$, $\mathcal{I}$ é chamada de \emph{balanceada} se a seguinte igualdade é satisfeita: 
  $$\sum_{\breve\pi_i~\in~\breve\pi}\breve\pi_i = \sum_{\breve\iota_i~\in~\breve\iota}\breve\iota_i.$$
  Caso contrário, $\mathcal{I}$ é chamada de \emph{desbalanceada}.
\end{definition}

O Exemplo~\ref{example:PHXDSEMJ} mostra uma instância intergênica rígida balanceada sem sinais.

\input{examples/PHXDSEMJ}

\begin{definition}
  Dada uma instância intergênica flexível $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$, $\mathcal{I}$ é chamada de \emph{balanceada} se a seguinte condição é satisfeita: 
  $$\sum_{\breve\iota^{\min}_i~\in~\breve\iota^{\min}} \breve\iota^{\min}_i \le \sum_{\breve\pi_i~\in~\breve\pi} \breve\pi_i \le \sum_{\breve\iota^{\max}_i~\in~\breve\iota^{\max}}{\breve\iota^{\max}_i}.$$
  Caso contrário, $\mathcal{I}$ é chamada de \emph{desbalanceada}.
\end{definition}

O Exemplo~\ref{example:PJKASBXB} mostra uma instância intergênica flexível balanceada com sinais.

\input{examples/PJKASBXB}

Note que instâncias intergênicas rígidas e flexíveis balanceadas possuem, no genoma de origem, um total de nucleotídeos em que é possível atender todas as restrições referentes aos tamanhos permitidos para cada região intergênica no genoma alvo. Por outro lado, em instâncias intergênicas rígidas e flexíveis desbalanceadas, é necessário inserir ou remover nucleotídeos nas regiões intergênicas do genoma de origem para ser possível transformá-lo no genoma alvo.

% ------------------------------------------------------------------ %
\section{Breakpoints}
% ------------------------------------------------------------------ %

Nesta seção, apresentamos os conceitos de breakpoints em instâncias clássicas e intergênicas rígidas. Esses conceitos são importantes para obtenção de limitantes inferiores e para o desenvolvimento de algoritmos.

% ------------------------------------------------------------------ %
\subsection{Breakpoint Clássico} \label{subsection:POEFMSHU}
% ------------------------------------------------------------------ %

Nesta seção, apresentamos o conceito de breakpoint para instâncias clássicas.

\begin{definition}
  Dada uma instância clássica $\mathcal{I} = (\pi,\iota)$, um par de elementos $(\pi_{i}, \pi_{i+1})$, de forma que $0 \le i \le n$, é um \emph{breakpoint clássico tipo um} se $|\pi_{i+1} - \pi_{i}| \ne 1$.
\end{definition}

\begin{definition}
  Dada uma instância clássica $\mathcal{I} = (\pi,\iota)$, um par de elementos $(\pi_{i}, \pi_{i+1})$, de forma que $0 \le i \le n$, é um \emph{breakpoint clássico tipo dois} se $\pi_{i+1} - \pi_{i} \ne 1$.
\end{definition}

Dada uma instância clássica $\mathcal{I} = (\pi,\iota)$, o número total de breakpoints clássicos tipo um é denotado por $b_{1}(\mathcal{I})$. A variação no número de breakpoints clássicos tipo um após a aplicação de uma sequência de eventos de rearranjo $S$ em $\pi$ é denotada por  $\Delta b_1(\mathcal{I},S) = b_1(\mathcal{I}^{\prime}) - b_1(\mathcal{I})$, onde $\mathcal{I}^{\prime} = (\pi^{\prime},\iota)$ e $\pi^{\prime} = \pi \cdot S$. O número total de breakpoints clássicos tipo dois é denotado por $b_{2}(\mathcal{I})$. A variação no número de breakpoints clássicos tipo dois após a aplicação de uma sequência de eventos de rearranjo $S$ em $\pi$ é denotada por $\Delta b_2(\mathcal{I},S) = b_2(\mathcal{I}^{\prime}) - b_2(\mathcal{I})$, onde $\mathcal{I}^{\prime} = (\pi^{\prime},\iota)$ e $\pi^{\prime} = \pi \cdot S$.

\begin{remark}\label{remark:AEYJTIDG}
  A única instância clássica $\mathcal{I}$ com $b_1(\mathcal{I}) = 0$ ou $b_2(\mathcal{I}) = 0$ é $\mathcal{I} = (\iota,\iota)$.
\end{remark}

\begin{definition}
  Dada uma instância clássica $\mathcal{I} = (\pi,\iota)$, \emph{strips} são sequências maximais de elementos de $\pi$ sem breakpoints clássicos.
\end{definition}

Uma strip obtida de uma instância clássica sem sinais $\mathcal{I} = (\pi,\iota)$ com apenas um elemento $\pi_i$ é chamada de \emph{singleton} e é definida como crescente caso  $i \in \{0,n\}$. Caso contrário, é definida como decrescente. Strips com mais de um elemento são chamadas de crescentes caso os elementos formem uma sequência crescente. Caso contrário, são chamadas de decrescentes. Uma strip obtida de uma instância clássica com sinais $\mathcal{I} = (\pi,\iota)$ é definida como positiva caso todos os elementos da strips tenham sinal positivo. Caso contrário, a strip é definida como negativa.

O Exemplo~\ref{example:PMRHWAPA} mostra uma instância clássica sem sinais $\mathcal{I} = ((0~1~2~5~4~3~6),\allowbreak(0~1~2~3~4~5~6))$. Note que a instância possui dois breakpoints clássicos tipo um ($b_{1}(\mathcal{I}) = 2$), sendo eles $(\pi_2,\pi_3)$ e $(\pi_5,\pi_6)$. Além disso, obtemos as seguintes strips da instância $\mathcal{I}$: $(0~1~2)$, $(5~4~3)$ e $(6)$, sendo que $(0~1~2)$ e $(6)$ são strips crescentes, enquanto $(5~4~3)$ é uma strip decrescente.

\input{examples/PMRHWAPA}

O Exemplo~\ref{example:POZIBUXA} mostra uma instância clássica com sinais $\mathcal{I} = \allowbreak(({+0}~{+1}~{+2}~{+5}~{-4}~{-3}\allowbreak~{+6}),\allowbreak({+0}~{+1}~{+2}~{+3}~{+4}~{+5}~{+6}))$. Note que a instância possui três breakpoints clássicos tipo dois ($b_{2}(\mathcal{I}) = 3$), sendo eles $(\pi_2,\pi_3)$, $(\pi_3,\pi_4)$ e $(\pi_5,\pi_6)$. As strips obtidas dessa instância com esses breakpoints clássicos tipo dois são: $({+0}~{+1}~{+2})$, $({+5})$, $({-4}~{-3})$ e $({+6})$. Sendo que $({+0}~{+1}~{+2})$, $({+5})$ e $({+6})$ são positivas enquanto a strip $({-4}~{-3})$ é negativa.

\input{examples/POZIBUXA}

% ------------------------------------------------------------------ %
\subsection{Breakpoint Intergênico}\label{subsection:JHXBSDPQ}
% ------------------------------------------------------------------ %

Nesta seção, apresentamos o conceito de breakpoint para instâncias intergênicas.

\begin{definition}
  Dada uma instância intergênica rígida $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota))$, um par de elementos $(\pi_{i}, \pi_{i+1})$, de forma que $0 \le i \le n$, é um \emph{breakpoint intergênico tipo um} se um dos seguintes casos ocorrer:
  \begin{itemize}
    \item $|\pi_{i+1} - \pi_{i}| \ne 1$
    \item $|\pi_{i+1} - \pi_{i}| = 1$ e $\breve\pi_{i+1} \ne \breve\iota_{x}$, tal que $x = \max(\pi_{i}, \pi_{i+1})$.
  \end{itemize}
\end{definition}

\begin{definition}
  Dada uma instância intergênica rígida $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota))$, um par de elementos $(\pi_{a}, \pi_{b})$ é uma \emph{adjacência intergênica} se $|a-b|=1$ e o par $(\pi_{\min(a,b)}, \pi_{\max(a,b)})$ não é um breakpoint intergênico tipo um.
\end{definition}

Note que um breakpoint intergênico tipo um indica um ponto no genoma de origem que deve ser afetado por algum rearranjo de genoma com o objetivo de transformá-lo no genoma alvo. Por outro lado, uma adjacência intergênica mostra um ponto no genoma de origem em que o par de genes considerados também são consecutivos no genoma alvo. Além disso, a região intergênica entre os genes tem o mesmo tamanho no genoma de origem e alvo.

\begin{definition}
  Dada uma instância intergênica rígida $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota))$, um breakpoint intergênico tipo um $(\pi_{i}, \pi_{i+1})$, tal que $|\pi_{i+1} - \pi_{i}| = 1$, é chamado de \emph{sobrecarregado} se $\breve\pi_{i+1} > \breve\iota_{x}$, com $x = \max(\pi_{i}, \pi_{i+1})$. Caso contrário, o breakpoint intergênico tipo um $(\pi_{i}, \pi_{i+1})$ é chamado de \emph{subcarregado}.
\end{definition}

Observe que um breakpoint intergênico sobrecarregado é formado por um par de genes que são consecutivos nos genomas de origem e alvo. Contudo, o tamanho da região intergênica entre o par de genes do genoma de origem é maior do que entre o mesmo par de genes no genoma alvo. Já um breakpoint intergênico subcarregado é justamente o cenário oposto: o par de genes são consecutivos nos genomas de origem e alvo, mas a região intergênica entre o par de genes do genoma de origem é menor do que entre o mesmo par de genes no genoma alvo.

\begin{definition}
  Um breakpoint intergênico tipo um $(\pi_{i}, \pi_{i+1})$ é chamado de \emph{forte} se $(\pi_{i}, \pi_{i+1})$ é um breakpoint intergênico sobrecarregado ou subcarregado. Caso contrário, o breakpoint intergênico tipo um $(\pi_{i}, \pi_{i+1})$ é chamado de \emph{suave}.
\end{definition}

\begin{definition}
  Um breakpoint intergênico forte $(\pi_{i}, \pi_{i+1})$ é chamado de \emph{super forte} se um dos seguintes casos ocorrer:
  \begin{itemize}
    \item $i \in \{0,n\}$
    \item $(\pi_{i-1}, \pi_{i})$ ou $(\pi_{i+1}, \pi_{i+2})$ é um breakpoint intergênico forte ou uma adjacência intergênica.
  \end{itemize}
\end{definition}

Note que um breakpoint intergênico super forte está em uma das extremidades do genoma de origem ou imediatamente antes ou depois existe um breakpoint intergênico forte ou uma adjacência intergênica.

\begin{definition}\label{definition:SUHDBNQI}
  Dada uma instância intergênica rígida $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota))$, um par de breakpoints intergênicos tipo um $(\pi_{i},\pi_{i+1})$ e $(\pi_{j},\pi_{j+1})$ é chamado de \emph{conectado} se ambas as condições a seguir são satisfeitas:
  \begin{enumerate}
    \item Existe um par de elementos dentre $(\pi_{i},\pi_{i+1})$, $(\pi_{j},\pi_{j+1})$, $(\pi_{i},\pi_{j})$, $(\pi_{i},\pi_{j+1})$, $(\pi_{i+1},\pi_{j})$ e $(\pi_{i+1},\pi_{j+1})$ que são consecutivos em $\iota$ e tal par não forma uma adjacência intergênica.
    \item $\breve\pi_{i+1} + \breve\pi_{j+1} \ge \breve\iota_{k}$, tal que $\breve\iota_{k}$ é o tamanho da região intergênica entre o par de elementos consecutivos (que satisfaz a condição 1) em $\iota$.
  \end{enumerate}
\end{definition}

Um par de breakpoints intergênicos conectados indica a possibilidade de criar uma adjacência intergênica utilizando apenas o material de ambos os breakpoints intergênicos tipo um (genes e nucleotídeos das regiões intergênicas).

\begin{definition}
Dada uma instância intergênica rígida $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota))$, um par de breakpoints intergênicos conectados $(\pi_{i},\pi_{i+1})$ e $(\pi_{j},\pi_{j+1})$ é chamado de \emph{suavemente conectado} se ambos os breakpoints intergênicos são suaves.
\end{definition}

\begin{definition}
  Dada uma instância intergênica rígida $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota))$, \emph{strips suaves} são sequências maximais de elementos de $\pi$ sem breakpoints intergênicos suaves.
\end{definition}

Uma strip suave com apenas um elemento $\pi_i$ é chamada de \emph{singleton} e é definida como crescente caso  $i \in \{0,n\}$. Caso contrário, é definida como decrescente. Strips suaves com mais de um elemento são chamadas de crescentes caso os elementos formem uma sequência crescente. Caso contrário, são chamadas de decrescentes.

\begin{definition}
  Dada uma instância intergênica rígida $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota))$, um par de elementos $(\pi_{i}, \pi_{i+1})$, de forma que $0 \le i \le n$, é um \emph{breakpoint intergênico tipo dois} se um dos seguintes casos ocorrer:
  \begin{itemize}
    \item $\pi_{i+1} - \pi_{i} \ne 1$
    \item $\pi_{i+1} - \pi_{i} = 1$ e $\breve\pi_{i+1} \ne \breve\iota_{x}$, tal que $x = \max(|\pi_{i}|, |\pi_{i+1}|)$.
  \end{itemize}
\end{definition}

Os breakpoints intergênicos tipo um e dois são utilizados dependendo do tipo da instância intergênica rígida (com ou sem sinais) e do modelo de rearranjo que é considerado, mas ambos os conceitos indicam a mesma informação: os pontos que devem ser afetados no genoma de origem para transformá-lo no genoma alvo.

Dada uma instância intergênica rígida $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota))$, o número total de breakpoints fortes e suaves são denotados por $ib_f(\mathcal{I})$ e $ib_s(\mathcal{I})$, respectivamente. O número total de breakpoints intergênicos tipo um é denotado por $ib_{1}(\mathcal{I}) = ib_f(\mathcal{I}) + ib_s(\mathcal{I})$. A variação no número de breakpoints intergênicos tipo um após a aplicação de uma sequência de eventos de rearranjo $S$ em $(\pi,\breve\pi)$ é denotada por  $\Delta ib_1(\mathcal{I},S) = ib_1(\mathcal{I}^{\prime}) - ib_1(\mathcal{I})$, onde $\mathcal{I}^{\prime} = ((\pi^{\prime}, \breve\pi^{\prime}),(\iota,\breve\iota))$ e $(\pi^{\prime}, \breve\pi^{\prime}) = (\pi, \breve\pi) \cdot S$. O número total de breakpoints intergênicos tipo dois é denotado por $ib_{2}(\mathcal{I})$. A variação no número de breakpoints intergênicos tipo dois após a aplicação de uma sequência de eventos de rearranjo $S$ em $(\pi,\breve\pi)$ é denotada por  $\Delta ib_2(\mathcal{I},S) = ib_2(\mathcal{I}^{\prime}) - ib_2(\mathcal{I})$, onde $\mathcal{I}^{\prime} = ((\pi^{\prime}, \breve\pi^{\prime}),(\iota,\breve\iota))$ e $(\pi^{\prime}, \breve\pi^{\prime}) = (\pi, \breve\pi) \cdot S$.

\begin{remark}\label{remark:UDYJTHAH}
  A única instância intergênica rígida $\mathcal{I}$ com $ib_1(\mathcal{I}) = 0$ ou $ib_2(\mathcal{I}) = 0$ é $\mathcal{I} = ((\iota,\breve\iota),(\iota,\breve\iota))$.
\end{remark}

O Exemplo~\ref{example:RADQRLJI} mostra uma instância intergênica rígida sem sinais $\mathcal{I} = (((0~1~2~5~4~3\allowbreak~6),\allowbreak(5,5,3,1,1,2)),\allowbreak((0~1~2~3~4~5~6),\allowbreak(5,0,6,4,1,1)))$. Note que a instância possui quatro breakpoints intergênicos tipo um ($ib_{1}(\mathcal{I}) = 4$), sendo que $ib_f(\mathcal{I}) = 2$ e $ib_s(\mathcal{I}) = 2$. Os breakpoints intergênicos tipo um $(\pi_1,\pi_2)$ e $(\pi_4,\pi_5)$ são fortes, sendo que $(\pi_1,\pi_2)$ é super forte e sobrecarregado, enquanto $(\pi_4,\pi_5)$ é subcarregado. Os breakpoints intergênicos tipo um $(\pi_2,\pi_3)$ e $(\pi_5,\pi_6)$ são suaves. Entre os pares de breakpoints intergênicos que estão conectados na instância, podemos citar o par de breakpoints intergênicos tipo um $((\pi_1,\pi_2),(\pi_2,\pi_3))$, que está conectado, e o par de breakpoints intergênicos tipo um $((\pi_1,\pi_2),(\pi_4,\pi_5))$, que está suavemente conectado. Além disso, obtemos as seguintes strips suaves da instância $\mathcal{I}$: $(0~1~2)$, $(5~4~3)$ e $(6)$, sendo que $(0~1~2)$ e $(6)$ são strips suaves crescentes, enquanto $(5~4~3)$ é uma strip suave decrescente.

\input{examples/RADQRLJI}

O Exemplo~\ref{example:RCRLXZXC} mostra uma instância intergênica rígida com sinais $\mathcal{I} = \allowbreak((({+0}~{+1}~{+2}~\allowbreak{+5}~{-4}~{-3}~{+6}),\allowbreak(5,5,3,1,4,2)),\allowbreak(({+0}~{+1}~{+2}~{+3}~{+4}~{+5}~{+6}),\allowbreak(2,5,6,4,1,2)))$. Note que a instância possui quatro breakpoints intergênicos tipo dois ($ib_{2}(\mathcal{I}) = 4$), sendo eles $(\pi_0,\pi_1)$, $(\pi_2,\pi_3)$, $(\pi_3,\pi_4)$ e $(\pi_5,\pi_6)$.

\input{examples/RCRLXZXC}

% ------------------------------------------------------------------ %
\section{Regiões Intergênicas Flexíveis}\label{section:JISAQWNF}
% ------------------------------------------------------------------ %

Nesta seção, apresentamos alguns conceitos relacionados às regiões intergênicas em instâncias intergênicas flexíveis sem sinais. Esses conceitos são importantes para o desenvolvimento de algoritmos e limitantes inferiores para os problemas investigados nos capítulos seguintes.

\begin{definition}
  Dada uma instância intergênica flexível sem sinais $\mathcal{I} = ((\pi,\breve\pi),\break(\iota,\breve\iota^{\min},\breve\iota^{\max}))$, uma região intergênica $\breve\pi_i$ é chamada de \emph{estável} se $|\pi_{i} - \pi_{i - 1}| = 1$ e $\breve\iota^{\min}_k \le \breve\pi_i \le \breve\iota^{\max}_k$, tal que $k = \max(\pi_{i-1}, \pi_i)$. Caso contrário, a região intergênica $\breve\pi_i$ é chamada de \emph{instável}. 
\end{definition}

Uma região intergênica instável deve necessariamente ser afetada por um evento de rearranjo, seja para unir genes consecutivos no genoma alvo ou para alterar a quantidade de nucleotídeos na região intergênica. Dada uma instância intergênica flexível sem sinais $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$, os conjuntos de regiões intergênicas estáveis e instáveis em $\mathcal{I}$ são definidos como $\mathcal{S}_e(\mathcal{I})$ e $\mathcal{S}_i(\mathcal{I})$, respectivamente. O número de regiões intergênicas estáveis e instáveis em $\mathcal{I}$ é denotado por $ir_e(\mathcal{I})$ e $ir_i(\mathcal{I})$, respectivamente. A variação no número de regiões intergênicas instáveis após a aplicação de uma sequência de eventos de rearranjo $S$ em $(\pi,\breve\pi)$ é denotada por  $\Delta ir_i(\mathcal{I},S) = ir_i(\mathcal{I}^{\prime}) - ir_i(\mathcal{I})$, onde $\mathcal{I}^{\prime} = ((\pi^{\prime}, \breve\pi^{\prime}),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$ e $(\pi^{\prime}, \breve\pi^{\prime}) = (\pi, \breve\pi) \cdot S$.

Dada uma instância intergênica flexível sem sinais $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$ e seja $\breve\pi_i$ uma região intergênica estável. Denotamos por $gap_{\min}(\breve\pi_i) = \breve\pi_i - \breve\iota^{\min}_k$ e $gap_{\max}(\breve\pi_i) = \breve\iota^{\max}_k - \breve\pi_i$, tal que $k = \max(\pi_{i-1}, \pi_i)$, a quantidade de nucleotídeos que podem ser, respectivamente, removidos e adicionados mantendo $\breve\pi_i$ estável.

\begin{remark}\label{remark:EUSNDMWS}
Dada uma instância intergênica flexível sem sinais $\mathcal{I} = ((\pi,\breve\pi),\break(\iota,\breve\iota^{\min},\breve\iota^{\max}))$ tal que $ir_i(\mathcal{I}) = 0$, então $\pi = \iota$ e $\forall \breve\pi_i \in \breve\pi: \breve\iota^{\min}_i \le \breve\pi_i \le \breve\iota^{\max}_i$.
\end{remark}

De agora em diante, as definições e conceitos apresentados referem-se às instâncias intergênicas flexíveis balanceadas sem sinais, com a adoção de modelos compostos exclusivamente por eventos de rearranjo conservativos. Note que, dada uma instância intergênica flexível balanceada sem sinais $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$, todas as regiões intergênicas instáveis precisam ser removidas para transformar $(\pi,\breve\pi)$ em $(\iota,\breve\pi^{\prime})$, tal que $\forall \breve\pi^{\prime}_i \in \breve\pi^{\prime} : \breve\iota^{\min}_i \le \breve\pi^{\prime}_i \le \breve\iota^{\max}_i$. Entretanto, nesse caso em particular, temos que algumas regiões intergênicas estáveis também podem ser afetadas com esse objetivo, dependendo do total de nucleotídeos nas regiões intergênicas instáveis. Regiões intergênicas estáveis devem obrigatoriamente ser afetadas por algum evento de rearranjo conservativo se algum dos seguintes cenários ocorrer:

$$\texttt{(i)}~\sum_{\breve\pi_i \in \mathcal{S}_{i}(\mathcal{I})} \breve\pi_i < \sum_{\breve\iota_{i}^{\min}  \in \breve\iota^{\min}} \breve\iota_{i}^{\min} - \sum_{\breve\pi_i \in \mathcal{S}_{e}(\mathcal{I})} (\breve\pi_i - gap_{\min}(\breve\pi_i))$$
$$\texttt{(ii)}\sum_{\breve\pi_i \in \mathcal{S}_{i}(\mathcal{I})} \breve\pi_i > \sum_{\breve\iota_{i}^{\max}  \in \breve\iota^{\max}} \breve\iota_{i}^{\max} - \sum_{\breve\pi_i \in \mathcal{S}_{e}(\mathcal{I})} (\breve\pi_i + gap_{\max}(\breve\pi_i))$$

No cenário \texttt{(i)}, chamado de \emph{fonte}, a quantidade de nucleotídeos nas regiões intergênicas instáveis não é suficiente para torná-las estáveis. Dessa forma, nucleotídeos das regiões intergênicas estáveis devem ser transferidos para as regiões intergênicas instáveis. No cenário \texttt{(ii)}, chamado de \emph{sorvedouro}, a quantidade de nucleotídeos nas regiões intergênicas instáveis excede o limite total permitido para essas regiões intergênicas. Dessa forma, nucleotídeos das regiões intergênicas instáveis devem ser transferidos para as regiões intergênicas estáveis. Uma instância intergênica flexível balanceada sem sinais que não pertence ao cenário fonte ou sorvedouro, pertence ao cenário de \emph{equilíbrio}. Nesse caso, a quantidade de nucleotídeos nas regiões intergênicas instáveis é suficiente para torná-las estáveis. Com a possível necessidade de afetar algumas regiões intergênicas estáveis, temos a seguinte definição. 

\begin{definition}
  Dada uma instância intergênica flexível balanceada sem sinais $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$, uma região intergênica estável $\breve\pi_i$ é chamada de \emph{auxiliar} se $\breve\pi_i$ deve receber nucleotídeos de regiões intergênicas instáveis ou transferir nucleotídeos para regiões intergênicas instáveis. Caso contrário, $\breve\pi_i$ é chamada de \emph{definitiva}.
\end{definition}

O número total de regiões intergênicas auxiliares depende do cenário da instância $\mathcal{I}$. No caso do cenário fonte, o conjunto de regiões intergênicas auxiliares $\mathcal{S}_{a}(\mathcal{I})$ é tal que seu tamanho é mínimo e a seguinte restrição é satisfeita:

$$\sum_{\breve\pi_i \in \mathcal{S}_{a}(\mathcal{I})} gap_{\min}(\breve\pi_i) \ge \sum_{\breve\iota_{i}^{\min}  \in \breve\iota^{\min}} \breve\iota_{i}^{\min} - \sum_{\breve\pi_i \in \mathcal{S}_{e}(\mathcal{I})} (\breve\pi_i - gap_{\min}(\breve\pi_i)) - \sum_{\breve\pi_i \in \mathcal{S}_{i}(\mathcal{I})} \breve\pi_i$$

Note que o conjunto $\mathcal{S}_{a}(\mathcal{I})$ com tamanho mínimo pode ser facilmente obtido ordenando as regiões intergênicas estáveis em ordem decrescente pelo valor de $gap_{\min}$. Em seguida, cada região intergênica é rotulada como auxiliar até que a restrição seja satisfeita. No caso do cenário sorvedouro, o conjunto de regiões intergênicas auxiliares $\mathcal{S}_{a}(\mathcal{I})$ é tal que seu tamanho é mínimo e a seguinte restrição é satisfeita:

$$\sum_{\breve\pi_i \in \mathcal{S}_{a}(\mathcal{I})} gap_{\max}(\breve\pi_i) \ge \sum_{\breve\pi_i \in \mathcal{S}_{i}(\mathcal{I})} \breve\pi_i - \sum_{\breve\iota_{i}^{\max}  \in \breve\iota^{\max}} \breve\iota_{i}^{\max} - \sum_{\breve\pi_i \in \mathcal{S}_{e}(\mathcal{I})} (\breve\pi_i + gap_{\max}(\breve\pi_i))$$

Semelhante ao cenário anterior, o conjunto $\mathcal{S}_{a}(\mathcal{I})$ com tamanho mínimo também pode ser facilmente obtido ordenando as regiões intergênicas estáveis em ordem decrescente pelo valor de $gap_{\max}$ e efetuando a rotulação das regiões intergênicas como auxiliares até que a restrição seja satisfeita. Obtendo o conjunto $\mathcal{S}_{a}(\mathcal{I})$, temos que o conjunto das regiões intergênicas definitivas $\mathcal{S}_{d}(\mathcal{I})$ pode ser obtido pela operação $\mathcal{S}_{e}(\mathcal{I}) - \mathcal{S}_{a}(\mathcal{I})$. Note que $\mathcal{S}_{a}(\mathcal{I}) \cup \mathcal{S}_{d}(\mathcal{I}) = \mathcal{S}_{e}$.

Caso o cenário de equilíbrio ocorra, então temos que $\mathcal{S}_{a}(\mathcal{I})=\emptyset$ e $ \mathcal{S}_{d}(\mathcal{I}) = \mathcal{S}_{e}$, ou seja, o total de nucleotídeos nas regiões intergênicas instáveis é suficiente para torná-las estáveis sem ser preciso afetar as regiões intergênicas estáveis. Dada uma instância intergênica flexível balanceada sem sinais $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$, o número de regiões intergênicas auxiliares em $\mathcal{I}$ é denotado por $ir_a(\mathcal{I})$. A variação no número de regiões intergênicas auxiliares após aplicar uma sequência de eventos de rearranjo $S$ em $(\pi,\breve\pi)$ é denotada por $\Delta ir_a(\mathcal{I},S) = ir_a(\mathcal{I}^{\prime}) - ir_a(\mathcal{I})$, onde $\mathcal{I}^{\prime} = ((\pi^{\prime}, \breve\pi^{\prime}),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$ e $(\pi^{\prime}, \breve\pi^{\prime}) = (\pi, \breve\pi) \cdot S$.

\begin{remark}\label{remark:PGEYZJME}
Dada uma instância intergênica flexível balanceada sem sinais $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$ tal que $ir_i(\mathcal{I}) + ir_a(\mathcal{I}) = 0$, então $\pi = \iota$ e $\forall \breve\pi_i \in \breve\pi: \breve\iota^{\min}_i \le \breve\pi_i \le \breve\iota^{\max}_i$.
\end{remark}

O Exemplo~\ref{example:RDGJHSWZ} mostra uma instância intergênica flexível balanceada sem sinais $\mathcal{I} = (((0~1~2~5~4~3~6),(5,0,3,1,6,2)),((0~1~2~3~4~5~6),(4,3,3,2,2,1),(6,4,8,7,3,3)))$ que pertence ao cenário fonte. Note que a instância $\mathcal{I}$ possui quatro regiões intergênicas instáveis ($ir_i(\mathcal{I}) = 4$, com $\mathcal{S}_{i}=\{\breve\pi_2,\breve\pi_3,\breve\pi_4,\breve\pi_6\}$) e duas regiões intergênicas estáveis ($\mathcal{S}_{e}=\{\breve\pi_1,\breve\pi_5\}$). No exemplo, temos apenas uma região intergênica auxiliar ($ir_a(\mathcal{I}) = 1$ e $\mathcal{S}_{a}=\{\breve\pi_5\}$). Note que $gap_{\min}(\breve\pi_1) = 1$ e $gap_{\min}(\breve\pi_5) = 4$.

\pagebreak

\input{examples/RDGJHSWZ}

O Exemplo~\ref{example:SCUCIMVA} mostra uma instância intergênica flexível balanceada sem sinais $\mathcal{I} = (((0~1~2~5~4~3~6),(4,3,4,1,2,8)),((0~1~2~3~4~5~6),(4,2,1,2,0,1),(6,4,3,7,1,3)))$ que pertence ao cenário sorvedouro. Note que a instância $\mathcal{I}$ possui duas regiões intergênicas instáveis ($ir_i(\mathcal{I}) = 2$ e $\mathcal{S}_{i}=\{\breve\pi_3,\breve\pi_6\}$) e quatro regiões intergênicas estáveis ($\mathcal{S}_{e}=\{\breve\pi_1,\breve\pi_2,\breve\pi_4,\breve\pi_5\}$). No exemplo, temos duas regiões intergênica auxiliares ($ir_a(\mathcal{I}) = 2$ e $\mathcal{S}_{a}=\{\breve\pi_1,\breve\pi_5\}$). Note que $gap_{\max}(\breve\pi_1) = 2$, $gap_{\max}(\breve\pi_2) = 1$, $gap_{\max}(\breve\pi_4) = 0$ e $gap_{\max}(\breve\pi_5) = 5$.

\input{examples/SCUCIMVA}

O Exemplo~\ref{example:TUDHODFC} mostra uma instância intergênica flexível balanceada sem sinais $\mathcal{I} = (((0~1~2~5~4~3~6),(5,5,3,1,2,3)),((0~1~2~3~4~5~6),(2,4,1,5,1,4),(4,6,3,7,3,6)))$ que não pertence ao cenário fonte ou sorvedouro. Note que por esse motivo a instância não possui regiões intergênicas auxiliares, ou seja, $ir_a(\mathcal{I}) = 0$ e $\mathcal{S}_{a}=\emptyset$. A instância $\mathcal{I}$ possui cinco regiões intergênicas instáveis ($ir_i(\mathcal{I}) = 5$ e $\mathcal{S}_{i}=\{\breve\pi_1,\breve\pi_3,\breve\pi_4,\breve\pi_5,\breve\pi_6\}$) e uma região intergênica estável ($\mathcal{S}_{e}=\{\breve\pi_2\}$).

\input{examples/TUDHODFC}

% ------------------------------------------------------------------ %
\section{Grafo de Ciclos}
% ------------------------------------------------------------------ %

Grafos são estruturas amplamente utilizadas em problemas de rearranjo de genomas para obtenção de limitantes inferiores e algoritmos. Nesta seção, apresentamos os grafos de ciclos clássico, ponderado e ponderado flexível.

% ------------------------------------------------------------------ %
\subsection{Grafo de Ciclos Clássico}\label{subsection:LSNDQWPI}
% ------------------------------------------------------------------ %

O grafo de ciclos clássico, também chamado de grafo de breakpoints, tem seu uso bastante difundido em problemas de rearranjo de genomas que utilizam instâncias clássicas. Esse grafo evidencia em uma mesma estrutura as adjacências presentes no genoma de origem e as adjacências desejadas no genoma alvo. A seguir definimos formalmente o grafo de ciclos clássico.

Dada uma instância clássica $\mathcal{I} = (\pi,\iota)$, definimos o grafo de ciclos clássico por $G(\mathcal{I}) = (V, E, \ell)$, tal que $V$, $E$ e $\ell$ representam o conjunto de vértices, o conjunto de arestas e uma função de rotulação de arestas, respectivamente. O conjunto de vértices $V$ é dado por $\{{+\pi_0}, {-\pi_1}, {+\pi_1}, {-\pi_2}, {+\pi_2}, \dots, {-\pi_n}, {+\pi_n}, {-\pi_{n+1}}\}$. Note que para cada elemento $\pi_i$, com $1 \le i \le n$, adicionamos em $V$ os vértices ${-\pi_i}$ e ${+\pi_i}$. Por fim, adicionamos em $V$ os vértices ${+\pi_0}$ e ${-\pi_{n+1}}$. O conjunto de arestas $E = E_p \cup E_c$ é dividido nos conjuntos de arestas pretas ($E_p$) e arestas cinzas ($E_c$), onde $E_p = \{(-\pi_i, +\pi_{i-1}) \,|\, 1 \leq i \leq n+1\}$ e $E_c = \{(+(i-1), -i) \,|\, 1 \leq i \leq n + 1\}$. Perceba que as arestas pretas representam os elementos adjacentes na permutação $\pi$, enquanto as arestas cinzas representam os elementos  adjacentes em $\iota$.

Existem diferentes formas de desenhar o grafo de ciclos clássico. Entretanto, utilizaremos a forma que chamamos de \emph{padrão}. Para essa forma de desenhar o grafo, os vértices são posicionados horizontalmente da esquerda para direita, seguindo a ordem ${+\pi_0}, {-\pi_1}, {+\pi_1}, {-\pi_2}, {+\pi_2}, \dots, {-\pi_n}, {+\pi_n}, {-\pi_{n+1}}$. As arestas pretas são desenhadas formando uma linha horizontal contínua, enquanto as arestas cinzas formam arcos com linhas tracejadas sobre os vértices. O Exemplo~\ref{example:UKGIKUAH} mostra o grafo de ciclos clássico construído a partir da instância clássica $\mathcal{I} = (({+0}~{+4}~{+3}~{-1}~{+2}~{+5}~{+6}),({+0}~{+1}~{+2}~{+3}~{+4}~{+5}~{+6}))$.

\input{examples/UKGIKUAH}

Pelo Exemplo~\ref{example:UKGIKUAH}, podemos perceber que o grafo de ciclos clássico possui $2n+2$ vértices e $2n+2$ arestas ($n+1$ pretas e $n+1$ cinzas), sendo que em cada vértice duas arestas são incidentes, uma preta e uma cinza. Por esse motivo, há uma decomposição única de $G(\mathcal{I})$ em ciclos com arestas de cores alternadas. 

A função de rotulação $\ell : E_p \rightarrow \{-(n+1),-n,\dots,-2,-1,1,2,\dots,n,(n+1)\}$ atribui um rótulo para cada aresta preta no grafo em função da direção em que a aresta é percorrida. Dada uma aresta preta $e_p = (-\pi_i, +\pi_{i-1}) \in E_p$, a função $\ell$ atribui o rótulo $i$ em $e_p$ caso ela seja percorrida de $-\pi_i$ até $+\pi_{i-1}$. Caso contrário, $e_p$ é rotulada com $-i$. Por padrão, cada ciclo de $G(\mathcal{I})$ é representado pela sequência de rótulos de suas arestas pretas na ordem em que elas são percorridas, sendo que a primeira aresta preta de um ciclo é aquela que encontra-se mais a direita no grafo e é percorrida da direita para esquerda, ou seja, de $-\pi_i$ até $+\pi_{i-1}$. Essa representação utilizada para os ciclos faz com que eles sejam representados unicamente. No Exemplo~\ref{example:UKGIKUAH}, $G(\mathcal{I})$ possui três ciclos: $C_1=(4,-1,-3)$, $C_2 = (5,2)$ e $C_3 = (6)$.

O tamanho de um ciclo $C\in G(\mathcal{I})$ é dado pela quantidade de arestas pretas do ciclo. Um ciclo de tamanho um é chamado de \emph{trivial}. Um ciclo com tamanho menor que três é chamado de \emph{curto}. Caso contrário, é chamado de \emph{longo}. 

\begin{definition}
Duas arestas pretas de um ciclo $C\in G(\mathcal{I})$ são chamadas de \emph{divergentes} se elas são percorridas em direções opostas. Caso contrário, são chamadas de \emph{convergentes}.
\end{definition}
\begin{definition}
Um ciclo $C\in G(\mathcal{I})$ é chamado de \emph{divergente} se pelo menos um par de arestas pretas de $C$ são divergentes. Caso contrário, $C$ é chamado de \emph{convergente}.
\end{definition}

Podemos ainda classificar ciclos convergentes como \emph{orientados} ou \emph{não orientados}. 

\begin{definition}
Um ciclo convergente $C = (c_1,c_2,\dots,c_k) \in G(\mathcal{I})$ é classificado como \emph{não orientado} se $c_i > c_{i+1}$, para todo $i$ com $1 \le i < k$. Caso contrário, $C$ é classificado como \emph{orientado}.
\end{definition}

Dois ciclos $C = (c_1, c_2, \ldots, c_k)$ e $D = (d_1, d_2, \ldots, d_k)$, ambos pertencentes ao grafo $G(\mathcal{I})$, são \emph{entrelaçados} se $|c_1| > |d_1| > |c_2|  > |d_2| > \ldots > |c_k| > |d_k|$ ou $|d_1| > |c_1| > |d_2|  > |c_2| > \ldots > |d_k| > |c_k|$. Seja $g_1$ uma aresta cinza adjacente às arestas pretas com rótulos $x_1$ e $y_1$, tal que $|x_1| < |y_1|$ e que $g_2$ seja uma aresta cinza adjacente às arestas pretas com rótulos $x_2$ e $y_2$, tal que $|x_2| < |y_2|$. Dizemos que duas arestas cinzas $g_1$ e $g_2$ cruzam-se caso $|x_1| < |x_2| \le |y_1| < |y_2|$. Dois ciclos $C$ e $D$ cruzam-se caso uma aresta cinza de $C$ cruza-se com uma aresta cinza de $D$. Um \emph{open gate} é uma aresta cinza de um ciclo não trivial $C \in G(\mathcal{I})$ que não se cruza com nenhuma outra aresta cinza de $C$. Um open gate $g_1$ de $C$ é fechado se outra aresta cinza (de um ciclo diferente de $C$) cruza com $g_1$.

\begin{remark}\label{remark:JBJWNCKF}
Todos os open gates em $G(\mathcal{I})$ são fechados~\cite{1996-bafna-pevzner}.
\end{remark}

No Exemplo~\ref{example:UKGIKUAH}, os ciclos $C_1=(4,-1,-3)$, $C_2 = (5,2)$ e $C_3 = (6)$ são, respectivamente, longo divergente, curto convergente orientado e trivial. Note que o ciclo $C_1$ possui o open gate $({+3},{-4})$, enquanto o ciclo $C_2$ possui os seguintes open gates: $({+2},{-3})$ e $({+4},{-5})$.

Dada uma instância clássica $\mathcal{I} = (\pi,\iota)$, denotamos por $c(G(\mathcal{I}))$ o número de ciclos em $G(\mathcal{I})$. Dada uma sequência de eventos de rearranjo $S$, denotamos por $\Delta c(G(\mathcal{I}), S) = c(G(\mathcal{I^{\prime}})) - c(G(\mathcal{I}))$, tal que $\mathcal{I^{\prime}} = (\pi \cdot S,\iota)$, a variação no número de ciclos após a aplicação da sequência $S$ no genoma de origem $\pi$ de $\mathcal{I}$.

\begin{remark}\label{remark:OYRVGHTB}
  A única instância clássica $\mathcal{I}$ com $c(G(\mathcal{I})) = n + 1$ é $\mathcal{I} = (\iota,\iota)$.
\end{remark}

% ------------------------------------------------------------------ %
\subsection{Grafo de Ciclos Ponderado Rígido}\label{subsection:SDWELPAZ}
% ------------------------------------------------------------------ %

O grafo de ciclos ponderado rígido é uma extensão do grafo de ciclos clássico, incorporando na sua estrutura, através de pesos nas arestas, informações referentes ao tamanho das regiões intergênicas do genoma de origem e do genoma alvo. A seguir, definimos formalmente o grafo de ciclos ponderado rígido.

Dada uma instância intergênica rígida $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota))$, definimos o grafo de ciclos ponderado rígido por $G(\mathcal{I}) = (V, E=E_p \cup E_c, \ell, w_p, w_c)$, tal que $V$, $E$ e $\ell$ representam, respectivamente, o conjunto de vértices, o conjunto de arestas e uma função de rotulação de arestas, enquanto $w_p$ e $w_c$ são funções de peso. Pelo fato do grafo de ciclos ponderado rígido tratar-se de uma extensão do grafo de ciclos clássico, $V$, $E$ e $\ell$ comportam-se exatamente como anteriormente descrito. Além disso, todos os conceitos, definições e representações que foram apresentados no contexto de grafo de ciclos clássico também são válidos e utilizados no grafo de ciclos ponderado rígido.

A função de peso $w_p : E_p \rightarrow \mathbb{N}_0$ associa os tamanhos das regiões intergênicas no genoma de origem com pesos nas arestas pretas do grafo. A função de peso $w_c : E_c \rightarrow \mathbb{N}_0$ funciona de maneira similar, mas associando os tamanhos das regiões intergênicas no genoma alvo com pesos nas arestas cinzas do grafo. Para cada aresta preta $e_i = (-\pi_i, +\pi_{i-1}) \in E_p$, temos que $w_p(e_i) = \breve\pi_i$. Para cada aresta cinza $e^{\prime}_i = (+(i-1), -i) \in E_c$, temos que $w_c(e^{\prime}_i) = \breve\iota_i$. Dado um ciclo $C \in G(\mathcal{I})$, denotamos por $E_p(C)$ e $E_c(C)$, respectivamente, os conjuntos de arestas pretas e cinzas que pertencem ao ciclo $C$. 

\begin{definition}
Um ciclo $C \in G(\mathcal{I})$ é chamado de \emph{balanceado} caso $\sum_{e^{\prime}_i \in E_c(C)} [w_c(e^{\prime}_i)] - \sum_{e_i \in E_p(C)} [w_p(e_i)] = 0$. Caso contrário, o ciclo $C$ é chamado de \emph{desbalanceado}.
\end{definition}

Em outras palavras, num ciclo balanceado a soma dos pesos em suas arestas pretas é a mesma que a soma dos pesos em suas arestas cinzas. 

\begin{definition}
Um ciclo desbalanceado $C \in G(\mathcal{I})$ é chamado de \emph{negativo} quando $\sum_{e^{\prime}_i \in E_c(C)} [w_c(e^{\prime}_i)] - \sum_{e_i \in E_p(C)} [w_p(e_i)] < 0$. Caso contrário, o ciclo $C$ é chamado de \emph{positivo}.
\end{definition}

Note que os eventos de rearranjo afetam apenas as arestas pretas no grafo de ciclos e suas extensões. Considerando um contexto composto por eventos conservativos, um ciclo negativo após ser afetado por evento de rearranjo apresenta um potencial maior de gerar novos ciclos balanceados, uma vez que existe peso suficiente em suas arestas pretas para atender o peso exigido em cada uma de suas arestas cinzas. Dada uma instância intergênica rígida $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota))$, denotamos por $c(G(\mathcal{I}))$ e $c_b(G(\mathcal{I}))$ o número de ciclos e o número ciclos balanceados em $G(\mathcal{I})$, respectivamente. Dada uma sequência de eventos de rearranjo $S$, denotamos por $\Delta c(G(\mathcal{I}), S) = c(G(\mathcal{I^{\prime}})) - c(G(\mathcal{I}))$ e $\Delta c_b(G(\mathcal{I}), S) = c_b(G(\mathcal{I^{\prime}})) - c_b(G(\mathcal{I}))$, tal que $\mathcal{I^{\prime}} = ((\pi,\breve\pi) \cdot S,(\iota,\breve\iota))$, a variação no número de ciclos e no número ciclos balanceados, respectivamente, após aplicar a sequência $S$ no genoma de origem $(\pi,\breve\pi)$ de $\mathcal{I}$.

O Exemplo~\ref{example:UMWQHOBI} mostra o grafo de ciclos ponderado rígido construído a partir da instância intergênica rígida $\mathcal{I} = ((({+0}~{+4}~{+3}~{-1}~{+2}~{+5}~{+6}),(0,6,2,5,1,3)),(({+0}~{+1}~{+2}\break{+3}~{+4}~{+5}~{+6}),(3,3,4,2,3,2)))$.

\input{examples/UMWQHOBI}

No Exemplo~\ref{example:UMWQHOBI}, os ciclos $C_1=(4,-1,-3)$, $C_2 = (5,2)$ e $C_3 = (6)$ são, respectivamente, longo positivo, curto balanceado e trivial negativo.

\begin{remark}\label{remark:WVLFPRDL}
  A única instância intergênica rígida $\mathcal{I}$ com $c(G(\mathcal{I})) = n + 1$ e $c_b(G(\mathcal{I})) = n + 1$ é $\mathcal{I} = ((\iota,\breve\iota),(\iota,\breve\iota))$.
\end{remark}

% ------------------------------------------------------------------ %
\subsection{Grafo de Ciclos Ponderado Flexível}\label{subsection:HUWEVNDS}
% ------------------------------------------------------------------ %

O grafo de ciclos ponderado flexível também é uma extensão do grafo de ciclos clássico, incorporando na sua estrutura, através de pesos nas arestas, informações referentes ao tamanho das regiões intergênicas do genoma de origem e os tamanhos mínimos e máximos permitidos para cada região intergênica no genoma alvo. A seguir, definimos formalmente o grafo de ciclos ponderado flexível.

Dada uma instância intergênica flexível $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$, definimos o grafo de ciclos ponderado flexível por $G(\mathcal{I}) = (V, E=E_p \cup E_c, \ell, w_p, w^{\min}_c, w^{\max}_c)$, tal que $V$, $E$ e $\ell$ representam, respectivamente, o conjunto de vértices, o conjunto de arestas e uma função de rotulação de arestas, enquanto $w_p$, $w^{\min}_c$ e $w^{\max}_c$ são funções de peso. Pelo fato do grafo de ciclos ponderado flexível também tratar-se de uma extensão do grafo de ciclos clássico, $V$, $E$ e $\ell$ comportam-se exatamente como já descrito. Além disso, todos os conceitos, definições e representações que foram apresentados no contexto de grafo de ciclos clássico também são válidos e utilizados no grafo de ciclos ponderado flexível.

A função de peso $w_p : E_p \rightarrow \mathbb{N}_0$ associa os tamanhos das regiões intergênicas no genoma de origem com pesos nas arestas pretas do grafo. As funções de peso $w^{\min}_c : E_c \rightarrow \mathbb{N}_0$ e $w^{\max}_c : E_c \rightarrow \mathbb{N}_0$ associam, respectivamente, os tamanhos mínimos e máximos permitidos para as regiões intergênicas no genoma alvo com pesos nas arestas cinzas do grafo. Para cada aresta preta $e_i = (-\pi_i, +\pi_{i-1}) \in E_p$, temos que $w_p(e_i) = \breve\pi_i$. Para cada aresta cinza $e^{\prime}_i = (+(i-1), -i) \in E_c$, temos que $w^{\min}_c(e^{\prime}_i) = \breve\iota^{\min}_i$ e $w^{\max}_c(e^{\prime}_i) = \breve\iota^{\max}_i$. Dado um ciclo $C \in G(\mathcal{I})$, denotamos por $E_p(C)$ e $E_c(C)$, respectivamente, os conjuntos de arestas pretas e cinzas que pertencem ao ciclo $C$. Dado um ciclo $C \in G(\mathcal{I})$, denotamos por $W_p(C)=\sum_{e_i \in E_p(C)} w_p(e_i)$, $W^{\min}_c(C)=\sum_{e^{\prime}_i \in E_c(C)} w^{\min}_c(e^{\prime}_i)$ e $W^{\max}_c(C)=\sum_{e^{\prime}_i \in E_c(C)} w^{\max}_c(e^{\prime}_i)$ o \emph{peso total}, \emph{peso mínimo total} e \emph{peso máximo total} de $C$, respectivamente. Note que o peso total de um ciclo é a soma dos pesos em suas arestas pretas. Já os pesos mínimo total e máximo total são, respectivamente, a soma dos pesos mínimos e máximos em suas arestas cinzas. 

\begin{definition}
Dada uma instância intergênica flexível $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$, um ciclo $C \in G(\mathcal{I})$ é chamado de \emph{estável} caso $W^{\min}_c(C) \le W_p(C) \le W^{\max}_c(C)$. Caso contrário, o ciclo $C$ é chamado de \emph{instável}.
\end{definition}

Em outras palavras, um ciclo estável indica que o peso total é suficiente para satisfazer as restrições relativas aos pesos mínimos e máximos em cada uma de suas arestas cinzas. Definimos os conjuntos de ciclos estáveis e instáveis em $G(\mathcal{I})$ como $\mathcal{S}_e(G(\mathcal{I}))$ e $\mathcal{S}_i(G(\mathcal{I}))$, respectivamente. Dado um ciclo $C \in G(\mathcal{I})$, denotamos por $gap_{\min}(C) = W_p(C) - W^{\min}_c(C)$ e $gap_{\max}(C) = W^{\max}_c(C) - W_p(C)$ os valores que se subtraídos e adicionados do peso total de $C$ resultam, respectivamente, nos pesos mínimo total e máximo total de $C$.

O Exemplo~\ref{example:VBQSYHZS} mostra o grafo de ciclos ponderado flexível construído a partir da instância intergênica flexível $\mathcal{I} = ((({+0}~{+4}~{+3}~{-1}~{+2}~{+5}~{+6}),(0,6,2,5,1,3)),(({+0}~{+1}~{+2}\break{+3}~{+4}~{+5}~{+6}),(5,4,2,0,1,2),(6,6,2,2,2,4)))$.

\input{examples/VBQSYHZS}

No Exemplo~\ref{example:VBQSYHZS}, os ciclos $C_1=(4,-1,-3)$, $C_2 = (5,2)$ e $C_3 = (6)$ são, respectivamente, longo instável, curto instável e trivial estável.

Dada uma instância intergênica flexível $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$, denotamos por $c(G(\mathcal{I}))$ e $c_e(G(\mathcal{I}))$ o número de ciclos e o número ciclos estáveis em $G(\mathcal{I})$, respectivamente. Dada uma sequência de eventos de rearranjo $S$, denotamos por $\Delta c(G(\mathcal{I}), S) = c(G(\mathcal{I^{\prime}})) - c(G(\mathcal{I}))$ e $\Delta c_e(G(\mathcal{I}), S) = c_e(G(\mathcal{I^{\prime}})) - c_e(G(\mathcal{I}))$, tal que $\mathcal{I^{\prime}} = ((\pi,\breve\pi) \cdot S,(\iota,\breve\iota))$, a variação no número de ciclos e no número ciclos estáveis, respectivamente, após a aplicação da sequência $S$ no genoma de origem $(\pi,\breve\pi)$ de $\mathcal{I}$.

\begin{remark}\label{remark:IRNWKUZA}
Dada uma instância intergênica flexível $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$, tal que $c(G(\mathcal{I})) = c_e(G(\mathcal{I})) = n+1$, temos que $\pi = \iota$ e $\breve\iota^{\min}_i \le \breve\pi_i \le \breve\iota^{\max}_i$ para todo $\breve\pi_i \in \breve\pi$.
\end{remark}

De agora em diante, as definições e conceitos apresentados referem-se às instâncias intergênicas flexíveis balanceadas cujos modelos são compostos exclusivamente por eventos de rearranjo conservativos. Note que, dada uma instância intergênica flexível balanceada $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$, todos os ciclos instáveis devem ser removidos e $G(\mathcal{I})$ deve possuir $n+1$ ciclos estáveis para transformar $(\pi,\breve\pi)$ em $(\iota,\breve\pi^{\prime})$, tal que $\forall \breve\pi^{\prime}_i \in \breve\pi^{\prime}, \breve\iota^{\min}_i \le \breve\pi^{\prime}_i \le \breve\iota^{\max}_i$. Dependendo da distribuição dos nucleotídeos e das restrições de tamanho mínimo e máximo nas arestas cinzas, alguns dos ciclos estáveis também devem ser afetados para realizar essa tarefa. Na verdade, existem dois cenários em que isso ocorre:

$$\texttt{(i)}~\sum_{C \in \mathcal{S}_i(G(\mathcal{I}))} W_p(C) < \sum_{C \in \mathcal{S}_i(G(\mathcal{I}))} W^{\min}_c(C)$$
$$\texttt{(ii)}\sum_{C \in \mathcal{S}_i(G(\mathcal{I}))} W_p(C) > \sum_{C \in \mathcal{S}_i(G(\mathcal{I}))} W^{\max}_c(C)$$

No cenário \texttt{(i)}, chamado de \emph{fonte}, a soma do peso total de todos os ciclos instáveis é menor que a soma do peso mínimo total dos mesmos ciclos, ou seja, não é possível atender todas as restrições de peso mínimo e máximo nas arestas cinzas dos ciclos instáveis sem que alguns ciclos estáveis transfiram uma determinada quantidade de peso de suas arestas pretas para os ciclos instáveis. No cenário \texttt{(ii)}, chamado de \emph{sorvedouro}, a soma do peso total de todos os ciclos instáveis é maior que a soma do peso máximo total dos mesmos ciclos. Nesse caso, alguns ciclos instáveis precisam transferir uma determinada quantidade de peso de suas arestas pretas para alguns dos ciclos estáveis. Uma instância intergênica flexível balanceada que não pertence ao cenário fonte ou sorvedouro, pertence ao cenário de \emph{equilíbrio}. Neste caso, é possível transformar os ciclos instáveis em estáveis sem afetar os demais ciclos estáveis da instância.

\begin{definition}
Dada uma instância intergênica flexível balanceada $\mathcal{I} = ((\pi,\breve\pi),\break(\iota,\breve\iota^{\min},\breve\iota^{\max}))$, um ciclo estável $C \in G(\mathcal{I})$ é chamado de \emph{auxiliar} se ele deve receber ou transferir peso de suas arestas pretas para outro ciclo, e é chamado de \emph{definitivo} caso contrário.
\end{definition}

Definimos os conjuntos de ciclos auxiliares e definitivos em $G(\mathcal{I})$ como $\mathcal{S}_a(G(\mathcal{I}))$ e $\mathcal{S}_d(G(\mathcal{I}))$, respectivamente. Observe que os cenários fonte e sorvedouro não ocorrem se $\sum_{C \in \mathcal{S}_i(G(\mathcal{I}))} W^{\min}_c(C) \le \sum_{C \in \mathcal{S}_i(G(\mathcal{I}))} W_p(C) \le \sum_{C \in \mathcal{S}_i(G(\mathcal{I}))} W^{\max}_c(C)$, onde temos que $\mathcal{S}_a(G(\mathcal{I})) = \emptyset$ e $\mathcal{S}_d(G(\mathcal{I})) = \mathcal{S}_e(G(\mathcal{I}))$ (Exemplo~\ref{example:VBQSYHZS}). Note que os cenários fonte e sorvedouro não podem ocorrer simultaneamente. Caso um deles ocorra, então é necessário determinar os conjuntos $\mathcal{S}_a(G(\mathcal{I}))$ e $\mathcal{S}_d(G(\mathcal{I}))$, que são dependentes do cenário em que a instância se encaixa. 


Considerando o cenário fonte, um conjunto $\mathcal{S}_a(G(\mathcal{I}))$ de tamanho mínimo pode ser composto do menor número de ciclos, de forma que a seguinte restrição seja cumprida: 

$$\sum_{C \in \mathcal{S}_a(G(\mathcal{I}))} gap_{\min}(C) + \sum_{C \in \mathcal{S}_i(G(\mathcal{I}))} gap_{\min}(C) \ge 0.$$

Considerando o cenário sorvedouro, um conjunto $\mathcal{S}_a(G(\mathcal{I}))$ de tamanho mínimo pode ser composto do menor número de ciclos, de forma  que a seguinte restrição seja cumprida: 

$$\sum_{C \in \mathcal{S}_a(G(\mathcal{I}))} gap_{\max}(C) + \sum_{C \in \mathcal{S}_i(G(\mathcal{I}))} gap_{\max}(C) \ge 0.$$

Observe que, em ambos os cenários, o conjunto $\mathcal{S}_a(G(\mathcal{I}))$ pode ser facilmente obtido após a ordenação, de forma decrescente, dos ciclos estáveis pelos valores $gap_{\min}$ e $gap_{\max}$, considerando os casos fonte e sorvedouro, respectivamente. Então, seguindo a ordem decrescente, os ciclos são rotulados como auxiliares até que a restrição seja satisfeita. O conjunto de ciclos definitivos $\mathcal{S}_d(G(\mathcal{I}))$ é obtido por $\mathcal{S}_e(G(\mathcal{I})) - \mathcal{S}_a(G(\mathcal{I}))$, note que $\mathcal{S}_a(G(\mathcal{I})) \cup \mathcal{S}_d(G(\mathcal{I})) = \mathcal{S}_e(G(\mathcal{I}))$.

Dada uma instância intergênica flexível balanceada $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$, denotamos por $c_d(G(\mathcal{I}))$ o número de ciclos definitivos em $G(\mathcal{I})$. Dada uma sequência de eventos de rearranjo $S$, denotamos por $\Delta c_d(G(\mathcal{I}), S) = c_d(G(\mathcal{I^{\prime}})) - c_d(G(\mathcal{I}))$, tal que $\mathcal{I^{\prime}} = ((\pi,\breve\pi) \cdot S,(\iota,\breve\iota))$, a variação no número de ciclos definitivos após a aplicação da sequência $S$ no genoma de origem $(\pi,\breve\pi)$ de $\mathcal{I}$.

\begin{remark}\label{remark:HLVDQLCE}
Seja $\mathcal{I} = ((\pi,\breve\pi),(\iota,\breve\iota^{\min},\breve\iota^{\max}))$ uma instância intergênica flexível balanceada tal que $c(G(\mathcal{I})) = c_d(G(\mathcal{I})) = n+1$, então temos que $\pi = \iota$ e $\breve\iota^{\min}_i \le \breve\pi_i \le \breve\iota^{\max}_i$ para todo $\breve\pi_i \in \breve\pi$.
\end{remark}

O Exemplo~\ref{example:SSQOHQDY} mostra o grafo de ciclos ponderado flexível construído a partir da instância intergênica flexível $\mathcal{I} = ((({+0}~{+3}~{+2}~{+1}~{+4}~{+5}~{+6}),(1,2,0,2,6,2)),(({+0}~{+1}~{+2}\break{+3}~{+4}~{+5}~{+6}),(3,2,4,0,2,1),(4,3,5,4,6,2)))$.

\input{examples/SSQOHQDY}

No Exemplo~\ref{example:SSQOHQDY}, $G(\mathcal{I})$ possui quatro ciclos, sendo eles: $C_1 = (3,1)$, $C_2 = (4,2)$, $C_3 = (5)$ e $C_4=(6)$. Além disso, temos os conjuntos $\mathcal{S}_i(G(\mathcal{I})) = \{C_1\}$ e $\mathcal{S}_e(G(\mathcal{I})) = \{C_2,C_3,C_4\}$. Observe que a instância intergênica flexível $\mathcal{I}$ do Exemplo~\ref{example:SSQOHQDY} pertence ao caso fonte, onde apenas o ciclo instável $C_1$ precisa aumentar o seu peso total para ser transformado em um ciclo estável ($1 = W_p(C_1) < W^{\min}_c(C_1) = 7$). Note que $gap_{\min}(C_2) = 2$, $gap_{\min}(C_3) = 4$ e $gap_{\min}(C_4) = 1$. Portanto, temos que $\mathcal{S}_a(G(\mathcal{I})) = \{C_2, C_3\}$ e $\mathcal{S}_d(G(\mathcal{I})) = \{C_4\}$.

O Exemplo~\ref{example:XSRSUPBR} mostra o grafo de ciclos ponderado flexível construído a partir da instância intergênica flexível $\mathcal{I} = ((({+0}~{+5}~{+4}~{+3}~{+2}~{+1}~{+6}),(1,2,4,2,6,2)),(({+0}~{+1}~{+2}\break{+3}~{+4}~{+5}~{+6}),(3,2,1,0,2,1),(4,3,1,4,3,4)))$.

\input{examples/XSRSUPBR}

No Exemplo~\ref{example:XSRSUPBR}, $G(\mathcal{I})$ possui dois ciclos, sendo eles: $C_1 = (5,3,1)$ e $C_2 = (6,4,2)$. Além disso, temos os conjuntos $\mathcal{S}_i(G(\mathcal{I})) = \{C_1\}$ e $\mathcal{S}_e(G(\mathcal{I})) = \{C_2\}$. Observe que a instância intergênica flexível $\mathcal{I}$ do Exemplo~\ref{example:XSRSUPBR} pertence ao caso sorvedouro, onde apenas o ciclo instável $C_1$ precisa reduzir o seu peso total para ser transformado em um ciclo estável ($11 = W_p(C_1) > W^{\max}_c(C_1) = 8$). Note que $gap_{\max}(C_2) = 5$. Portanto, temos que $\mathcal{S}_a(G(\mathcal{I})) = \{C_2\}$ e $\mathcal{S}_d(G(\mathcal{I})) = \emptyset$.