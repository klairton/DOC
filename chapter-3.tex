\chapter{Modelos com Porporção entre Operações}

Os problemas de distância entre genomas podem utilizar uma abordagem \emph{não ponderada}, ou seja, cada evento de rearranjo utilizado para transformar o genoma de origem no genoma alvo contribui em uma unidade para a distância. Essa abordagem tem como característica que cada tipo de evento de rearranjo, pertencente ao modelo de rearranjo adotado, possui a mesma probabilidade de ocorrer em um cenário evolutivo. Outra abordagem que surgiu para possibilitar uma contribuição diferente para cada evento de rearranjo é chamada de \emph{ponderada}. Nesse abordagem, cada tipo de evento de rearranjo possui um peso associado que é contabilizado na distância evolutiva entre os genomas. A abordagem ponderada geralmente é utilizada para mapear um cenário em que queremos que determinado eventos de rearrajo tenham uma possibilidade maior de ocorrer do que outros. Para isso, basta atribuir um peso menor nos eventos de rearranjo que esperados que ocorram mais. Esses pesos podem ser atribuídos com base em observações empíricas de determinados organismos ou através de análises realizadas especificamente para esse objetivo~\cite{2008-bader-etal,2001-eriksen}. 

Os eventos de rearranjo de reversão e transposição são dois dos eventos mais estudados na literatura~\cite{2002-berman-etal,2006-elias-hartman,2022-silva-etal}. Considerando uma representação clássica e uma abordagem não ponderada, temos o problema de Ordenção de Permutações por Reversões e Transposições (\SbRT), sendo que o problema possui a variação com e sem sinais. Ambas as variações pertencem à classe NP-difícil de problemas~\cite{2019b-oliveira-etal}, para a variação com sinais do problema existe um algoritmo de aproximação com fator 2~\cite{1998-walter-etal}. Para a variação sem sinais, existe um algoritmo de aproximação com fator $2k$~\cite{2008-rahman-etal}, onde $k$~\cite{2013-chen} é o fator de aproximação do algoritmo utilizado para a decomposição de ciclos do Grafo de Ciclos~\cite{1999-caprara}.

Considerando um abordagem poderada, temos o problema de Ordenção de Permutações por Reversões e Transposições Ponderadas (\SbWRT) na variação com e sem sinais. In 2002, Eriksen~\cite{2002-eriksen} apresentou um algoritmo com factor de aproximação $7/6$ para a variação com sinais do problema utilizando os pesos $1$ e $2$ para os eventos de reversão e transposição, respectivamente. Oliveira \textit{et al.}\cite{2019a-oliveira-etal} desenvolveram um algoritmo de aproximação com fator $1.5$ para a variação com sinais do problema \SbWRT{} utilizando os pesos $2$ e $3$ para os eventos de reversão e transposição, respectivamente. Além disso, os autores mostraram que as variações com e sem sinais do problema \SbWRT{} pertencem à classe NP-difícil quando a razão entre os pesos dos eventos de transposição e reversão é maior ou igual a $1.5$.  

Em 2007, Bader e Ohlebusch~\cite{2007-bader-ohlebusch} apresentaram o problema de Ordenção de Permutações por Reversões, Transposições e Transposições Inversa Ponderadas (\SbWRTIT). A transposição inversa é um evento similar ao evento de transposição, mas com um dos segmentos adjacentes afetados sendo invertido. Para a variação com sinais do problema os autores apresentaram um algoritmo de aproximação com fator $1.5$ utilizando o peso $1$ para o evento de reversão e o mesmo peso, no intervalo $[1..2]$, para os eventos de transposição e transposição inversa. Em 2020, Alexandrino \textit{et al.}\cite{2020b-alexandrino-etal} mostraram que as variações com e sem sinais do problema \SbWRTIT{} pertencem à classe NP-difícil quando os eventos de transposição e transposição inversa possuem o mesmo peso e a razão entre os pesos dos eventos de transposição e reversão é maior ou igual a $1.5$.

A abordagem ponderada possui vantagens em comparação com a abordagem não ponderada quando queremos mapear um cenário evolutivo dando mais prioridade para determinados tipos de eventos de rearranjo. Entretanto, ela não garantem que os rearranjos de menor custo, que são supostamente os mais frequentes em um cenário evolutivo, serão os mais utilizados pelos algoritmos. Para contornar esse ponto, propomos e investigamos o problema de Ordenção de Permutações por Reversões e Transposições com Restrição de Proporção (\SbPRT) em instâncias clássicas com e sem sinais. Neste cenário, buscamos uma sequência de reversões e transposições $S$ capaz de transformar o genoma de origem no genoma alvo com uma restrição adicional na qual a relação entre o número de reversões e o tamanho da sequência $S$ deve ser maior ou igual a um determinado parâmetro $k \in [0..1]$. 

Observe que tanto as abordagens ponderada e proporcional tentam incorporar no modelo a frequência na qual os eventos de rearranjo afetam o genoma de um determinado organismo. É importante notar que, do ponto de vista biológico, a frequência e o conjunto de eventos de rearranjo podem variar dependendo do organismo considerado. De um ponto de vista teórico, as abordagens possuem objetivos diferentes, apesar de compartilharem características comuns. Uma característica que difere da abordagem de proporção é que uma vez conhecida a frequência na qual os eventos afetam o genoma, a proporção pode ser facilmente derivada dessa informação, enquanto que na abordagem ponderada o peso associado a cada tipo de evento precisa ser ajustado e validado através de testes experimentais.

O Exemplo~\ref{example:DFGJNHTP} mostra uma solução ótimo $S$ para a instância clássica com sinais $(({+0}~{-1}~{+4}~{-8}~{+3}~{+5}~{+2}~{-7}~{-6}~{+9}),({+0}~{+1}~{+2}~{+3}~{+4}~{+5}~{+6}~{+7}~{+8}~{+9}))$ considerando os problemas \SbRT{} e \SbWRT{} (utilizando os pesos $2$ e $3$ para os eventos de reversão e transposição, respectivamente). Note que metade dos eventos de rearranjo de $S$ são reversões e a outra metade transposições, mesmo utilizando um custo maior para o evento de transposição.

\input{examples/DFGJNHTP}

O Exemplo~\ref{example:MODRXOJQ} mostra uma solução ótima $S'$ para a mesma instância clássica com sinais apresentada no Exemplo~\ref{example:DFGJNHTP} considerando o problem \SbPRT{} e adotando um valor de $k = 0.6$, ou seja, pelo menos 60\% dos eventos de rearranjo em $S'$ devem ser reversões. Quando comparamos com o Exemplo~\ref{example:DFGJNHTP}, podemos perceber que $S'$ possui apenas um evento a mais que $S$, mas a proporção mínima de reversões em relação ao tamanho da sequência $S'$ é garantida.

\input{examples/MODRXOJQ}

Dada uma sequência de eventos de rearranjo $S$, denotamos por $|S|$ o tamanho da sequência $S$, ou seja, a quantidade de eventos em $S$. Além disso, denotamos por $|S_{\rho}|$ pela quantidade de eventos de reversão em $S$. A seguir, descrevemos formalmente o problema de Ordenção de Permutações por Reversões e Transposições com Restrição de Proporção.

\begin{task}
  \problemtitle{Ordenção de Permutações por Reversões e Transposições com Restrição de Proporção (\SbPRT)}
  \probleminput{Uma instância clássica com ou sem sinais $\mathcal{I}=(\pi,\iota)$ e um número racional $k \in [0..1]$.}
  \problemtask{Com base no modelo de rearranjo $\mathcal{M}=\{\rho,\tau\}$, determinar uma sequência de eventos de rearranjo $S$ de tamanho mínimo capaz de transformar $\pi$ em $\iota$ e $\frac{|S_{\rho}|}{|S|} \ge k$.}
\end{task}

Nesse capítulo, provamos que o problema \SbPRT{} pertence à classe NP-difícil em instâncias clássicas sem sinais para qualquer valor de $k$. Em instâncias clássicas com sinais mostramos que existe um algoritmo exato polinomial para o problema quando $k=1$ e provamos que o problema pertence à classe NP-difícil quando $k < 1$. Para as variações com e sem sinais do problema \SbPRT{} apresentamos algoritmos de aproximação com fatores $3 - \frac{3k}{2}$ e $3-k$, respectivamente. Além disso, apresentamos um algoritmo de aproximação assintótico com um fator teórico melhor para instâncias clássicas com sinais. Por fim, realizamos experimentos comparando o desempenho práticos dos algoritmo propostos.  

% ------------------------------------------------------------------ %
\section{Análise de Complexidade}
% ------------------------------------------------------------------ %

Nessa seção, apresentamos uma análise sobre a complexidade do problema \SbPRT{} em instâncias com e sem sinais para todos os possível valores de $k$.

\begin{decision}
  \problemtitle{\SbPRT (Versão de Decisão)}
  \probleminput{Uma instância clássica com ou sem sinais $\mathcal{I}=(\pi,\iota)$, um número racional $k \in [0..1]$ e um número natural $t$.}
  \problemquestion{Existe uma sequência de eventos de rearranjo $S$, com base no modelo de rearranjo $\mathcal{M}=\{\rho,\tau\}$, capaz de transformar $\pi$ em $\iota$, com $\frac{|S_{\rho}|}{|S|} \ge k$ e $|S| \le t$.}
\end{decision}